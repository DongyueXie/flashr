% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/flash.R
\name{flash}
\alias{flash}
\title{Main flash function}
\usage{
flash(data, Kmax, column_covariates = NULL, row_covariates = NULL,
  f_init = NULL, init_fn = NULL, var_type = c("by_column", "constant"),
  tol = 0.01, ebnm_fn = ebnm_ash,
  ebnm_param = flash_default_ebnm_param(ebnm_fn), verbose = FALSE)
}
\arguments{
\item{data}{an n by p matrix or a flash data object created using \code{flash_set_data}}

\item{Kmax}{the maximum total number of factors to use}

\item{column_covariates}{an n by r1 matrix of covariates (eg could be a column of all 1s to allow an intercept for each column)}

\item{row_covariates}{a p by r2 matrix of covariates (eg could be a vector of p 1s to allow an intercept for each row)}

\item{f_init}{a previously fitted flash object to be added to or refined}

\item{init_fn}{function used to initialize factors and loadings,}

\item{var_type}{type of variance structure to assume for residuals.}

\item{tol}{specify how much objective can change in a single iteration to be considered not converged}

\item{ebnm_fn}{function to solve the Empirical Bayes Normal Means problem}

\item{ebnm_param}{parameters to be passed to ebnm_fn when optimizing; defaults set by flash_default_ebnm_param()}

\item{verbose}{if TRUE various output progress updates will be printed}
}
\value{
a fitted flash object
}
\details{
Performs Empirical Bayes factor analysis with adaptive shrinkage on both factors and loadings.
}
